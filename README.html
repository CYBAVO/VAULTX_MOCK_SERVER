<!DOCTYPE html>
<html>

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>README</title>


<style type="text/css">
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA09pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoMTMuMCAyMDEyMDMwNS5tLjQxNSAyMDEyLzAzLzA1OjIxOjAwOjAwKSAgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUM2NjlDQjI4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUM2NjlDQjM4ODBGMTFFMTg1ODlEODNERDJBRjUwQTQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5QzY2OUNCMDg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5QzY2OUNCMTg4MEYxMUUxODU4OUQ4M0REMkFGNTBBNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsQhXeAAAABfSURBVHjaYvz//z8DJYCRUgMYQAbAMBQIAvEqkBQWXI6sHqwHiwG70TTBxGaiWwjCTGgOUgJiF1J8wMRAIUA34B4Q76HUBelAfJYSA0CuMIEaRP8wGIkGMA54bgQIMACAmkXJi0hKJQAAAABJRU5ErkJggg==) no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAECAYAAACtBE5DAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OENDRjNBN0E2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OENDRjNBN0I2NTZBMTFFMEI3QjRBODM4NzJDMjlGNDgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4Q0NGM0E3ODY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4Q0NGM0E3OTY1NkExMUUwQjdCNEE4Mzg3MkMyOUY0OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqqezsUAAAAfSURBVHjaYmRABcYwBiM2QSA4y4hNEKYDQxAEAAIMAHNGAzhkPOlYAAAAAElFTkSuQmCC) repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0;
}

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }
li {
  margin: 0; }
ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0;border-collapse: collapse; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  background-color: #f8f8f8;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

.highlight pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }

pre {
  background-color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

sup {
    font-size: 0.83em;
    vertical-align: super;
    line-height: 0;
}

kbd {
  display: inline-block;
  padding: 3px 5px;
  font-size: 11px;
  line-height: 10px;
  color: #555;
  vertical-align: middle;
  background-color: #fcfcfc;
  border: solid 1px #ccc;
  border-bottom-color: #bbb;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #bbb
}

* {
	-webkit-print-color-adjust: exact;
}
@media screen and (min-width: 914px) {
    body {
        width: 854px;
        margin:0 auto;
    }
}
@media print {
	table, pre {
		page-break-inside: avoid;
	}
	pre {
		word-wrap: break-word;
	}
}
</style>


</head>

<body>

<p><a name="table-of-contents"></a></p>

<h2 id="toc_0">Table of contents</h2>

<ul>
<li><a href="#get-started">Get Started</a></li>
<li>VAULT X API

<ul>
<li><a href="#register-new-user">Register New User</a></li>
<li><a href="#pair-device">Pair Device</a></li>
<li><a href="#setup-pin-code">Setup PIN Code</a></li>
<li><a href="#repair-device">Repair Device</a></li>
<li><a href="#issue-user-login-request">Issue User Login Request</a></li>
<li><a href="#query-user-status">Query User Status</a></li>
<li><a href="#backup-user-key">Backup User Key</a></li>
<li><a href="#restore-user-key">Restore User Key</a></li>
<li><a href="#sign-message">Sign Message</a></li>
<li><a href="#sign-raw-transaction">Sign Raw Transaction</a></li>
<li><a href="#decrypt-message">Decrypt Message</a></li>
<li><a href="#query-callback-status">Query Callback Status</a></li>
</ul></li>
<li>Testing

<ul>
<li><a href="#mock-server">Mock Server</a></li>
<li><a href="#curl-testing-commands">CURL Testing Commands</a></li>
</ul></li>
<li>Appendix

<ul>
<li><a href="#callback-definition">Callback Definition</a></li>
<li><a href="#api-callback-list">API Callback List</a></li>
<li><a href="#setup-getnonce-api">Setup getnonce API</a></li>
</ul></li>
</ul>

<p><a name="get-started"></a></p>

<h1 id="toc_1">Get Started</h1>

<ul>
<li>Get API code and API secret on web admin console</li>
<li>Setup callback URL and getnonce API URL</li>
<li>Refer to <a href="#mock-server">mock server</a> sample code </li>
</ul>

<h1 id="toc_2">VAULTX API</h1>

<p><a name="register-new-user"></a></p>

<h2 id="toc_3">Register New User</h2>

<p>Register a new user.</p>

<p><strong><code>POST</code></strong> /v1/vaultx/users </p>

<ul>
<li><a href="#curl-register-new-user">Sample curl command</a></li>
</ul>

<h5 id="toc_4">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_5">Post body</h6>

<div><pre><code class="language-javascript">{
  &quot;name&quot;: &quot;JOHN DOE&quot;,
  &quot;email&quot;: &quot;johndoe@example.com&quot;,
  &quot;locale&quot;: &quot;en&quot;
}</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_6">Post body</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">name</td>
<td style="text-align: left">string</td>
<td style="text-align: left">User name</td>
</tr>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">User email</td>
</tr>
<tr>
<td style="text-align: left">locale</td>
<td style="text-align: left">string</td>
<td style="text-align: left">User preference locale (en, zh-TW, zh-CN, ja, ko)</td>
</tr>
</tbody>
</table>

<h5 id="toc_7">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;email&quot;: &quot;johndoe@example.com&quot;
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Registered user&#39;s email</td>
</tr>
</tbody>
</table>

<h4 id="toc_8">Possible Errors</h4>

<table>
<thead>
<tr>
<th style="text-align: left">HTTP Status Code</th>
<th style="text-align: left">Error Code</th>
<th style="text-align: left">Error Message</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">400</td>
<td style="text-align: left">103</td>
<td style="text-align: left">Account already exists</td>
</tr>
</tbody>
</table>

<h5 id="toc_9">Refer to <a href="#common-errors">Common Errors</a></h5>

<h5 id="toc_10"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="pair-device"></a></p>

<h2 id="toc_11">Pair Device</h2>

<p>Pair device with user. </p>

<blockquote>
<p>This API has a callback.</p>
</blockquote>

<p><strong><code>POST</code></strong> /v1/vaultx/devices?email=<code>USER_EMAIL</code>&amp;company_id=<code>COMPANY_ID</code></p>

<ul>
<li><a href="#curl-pair-device">Sample curl command</a></li>
</ul>

<h5 id="toc_12">Request Format</h5>

<p>An example of the reques:</p>

<h6 id="toc_13">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/devices?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_14">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">number</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h5 id="toc_15">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;order_id&quot;: 40000000003,
  &quot;url&quot;: &quot;http://192.168.0.56:8080/v1/cybavob/otp/token?product=vaultx&amp;token=oyZSzs6NX5Tx78_VLieH2rwCbCNIM4XsOJ-SvMqpCK4=&quot;
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">order_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Callback ID. Use this ID to identify specific callback.</td>
</tr>
<tr>
<td style="text-align: left">url</td>
<td style="text-align: left">string</td>
<td style="text-align: left">URL to bind device with user. Convert to QR code then scan with CYBAVO Auth APP.</td>
</tr>
</tbody>
</table>

<h4 id="toc_16">Callback</h4>

<p>An example of a callback:</p>

<div><pre><code class="language-none">{
  &quot;behavior_result&quot;: 2,
  &quot;behavior_type&quot;: 4,
  &quot;company_id&quot;: 1,
  &quot;order_id&quot;: 40000000003
 }</code></pre></div>

<ul>
<li><a href="#callback-definition">View callback definition</a></li>
</ul>

<h4 id="toc_17">Possible Errors</h4>

<table>
<thead>
<tr>
<th style="text-align: left">HTTP Status Code</th>
<th style="text-align: left">Error Code</th>
<th style="text-align: left">Error Message</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">400</td>
<td style="text-align: left">177</td>
<td style="text-align: left">User already has paired device, please use re-pair api if you want to do re-pair action</td>
</tr>
</tbody>
</table>

<h5 id="toc_18">Refer to <a href="#common-errors">Common Errors</a></h5>

<h5 id="toc_19"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="setup-pin-code"></a></p>

<h2 id="toc_20">Setup PIN Code</h2>

<p>Setup user PIN code.</p>

<blockquote>
<p>This API has a callback.</p>

<p>The requester needs to set the PIN code on the CYBAVO Auth APP after issuing the API request.</p>
</blockquote>

<p><strong><code>POST</code></strong> /v1/vaultx/user/pin?email=<code>USER_EMAIL</code>&amp;company_id=<code>COMPANY_ID</code></p>

<ul>
<li><a href="#curl-setup-pin-code">Sample curl command</a></li>
</ul>

<h5 id="toc_21">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_22">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/users/pin?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_23">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">number</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h5 id="toc_24">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;order_id&quot;: 50000000004
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">order_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Callback ID. Use this ID to identify specific callback.</td>
</tr>
</tbody>
</table>

<h4 id="toc_25">Callback</h4>

<p>An example of a callback:</p>

<div><pre><code class="language-none">{
  &quot;behavior_result&quot;: 2,
  &quot;behavior_type&quot;: 5,
  &quot;company_id&quot;: 1,
  &quot;order_id&quot;: 50000000004
}</code></pre></div>

<ul>
<li><a href="#callback-definition">View callback definition</a></li>
</ul>

<h4 id="toc_26">Possible Errors</h4>

<table>
<thead>
<tr>
<th style="text-align: left">HTTP Status Code</th>
<th style="text-align: left">Error Code</th>
<th style="text-align: left">Error Message</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">400</td>
<td style="text-align: left">176</td>
<td style="text-align: left">User already has pin</td>
</tr>
</tbody>
</table>

<h5 id="toc_27">Refer to <a href="#common-errors">Common Errors</a></h5>

<h5 id="toc_28"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="repair-device"></a></p>

<h2 id="toc_29">Repair Device</h2>

<p>Following steps below to complete device reparing process.</p>

<blockquote>
<p>This process has a callback.</p>
</blockquote>

<ul>
<li><a href="#curl-repair-device">Sample curl command</a></li>
</ul>

<h4 id="toc_30">Step 1: Issue a device repairing request</h4>

<p><strong><code>POST</code></strong> /v1/vaultx/devices/repair?email=<code>USER_EMAIL</code>&amp;company_id=<code>COMPANY_ID</code></p>

<h5 id="toc_31">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_32">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/devices/repair?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_33">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">number</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h5 id="toc_34">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;token&quot;: &quot;yMYoEfHenKLDAAMIdVLW5zGrn9E4ap0qE5VrGoXlQaE=&quot;
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">token</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Submit this token in step 3</td>
</tr>
</tbody>
</table>

<h4 id="toc_35">Step 2: Check requester&#39;s email to get 6-digit verification code</h4>

<h4 id="toc_36">Step 3: Continue repairing process</h4>

<p><strong><code>POST</code></strong> /v1/vaultx/devices/repair?email=<code>USER_EMAIL</code>&amp;company_id=<code>COMPANY_ID</code></p>

<h5 id="toc_37">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_38">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/devices/repair?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<h6 id="toc_39">Post body</h6>

<div><pre><code class="language-javascript">{
  &quot;token&quot;: &quot;yMYoEfHenKLDAAMIdVLW5zGrn9E4ap0qE5VrGoXlQaE=&quot;,
  &quot;verify_num&quot;: 908520
}</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_40">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">number</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h6 id="toc_41">Post body</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">token</td>
<td style="text-align: left">string</td>
<td style="text-align: left">The token received in step 1</td>
</tr>
<tr>
<td style="text-align: left">verify_num</td>
<td style="text-align: left">number</td>
<td style="text-align: left">The 6-digit verification code received in requester&#39;s email</td>
</tr>
</tbody>
</table>

<h5 id="toc_42">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;order_id&quot;: 40000000005,
  &quot;url&quot;: &quot;http://192.168.0.56:8080/v1/cybavob/otp/rebind?token=A3Rll4djJt5vphKN77wovhYs0XHSt1TKsV9996pwnlY=&quot;
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">order_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Callback ID. Use this ID to identify specific callback.</td>
</tr>
<tr>
<td style="text-align: left">url</td>
<td style="text-align: left">string</td>
<td style="text-align: left">URL to bind device with user. Convert to QR code then scan with CYBAVO Auth APP.</td>
</tr>
</tbody>
</table>

<h4 id="toc_43">Callback</h4>

<p>An example of a callback:</p>

<div><pre><code class="language-none">{
  &quot;behavior_result&quot;: 2,
  &quot;behavior_type&quot;: 4,
  &quot;company_id&quot;: 1,
  &quot;order_id&quot;: 40000000005
}</code></pre></div>

<ul>
<li><a href="#callback-definition">View callback definition</a></li>
</ul>

<h4 id="toc_44">Possible Errors</h4>

<table>
<thead>
<tr>
<th style="text-align: left">HTTP Status Code</th>
<th style="text-align: left">Error Code</th>
<th style="text-align: left">Error Message</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">400</td>
<td style="text-align: left">173</td>
<td style="text-align: left">Pair device process not completed</td>
</tr>
</tbody>
</table>

<h5 id="toc_45">Refer to <a href="#common-errors">Common Errors</a></h5>

<h5 id="toc_46"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="issue-user-login-request"></a></p>

<h2 id="toc_47">Issue User Login Request</h2>

<p>Issue a login request. Requester needs to confirm request on the CYBAVO Auth APP.</p>

<blockquote>
<p>This API has a callback.</p>
</blockquote>

<p><strong><code>POST</code></strong> /v1/vaultx/loginverify?email=<code>USER_EMAIL</code>&amp;company_id=<code>COMPANY_ID</code></p>

<ul>
<li><a href="#curl-issue-user-login-request">Sample curl command</a></li>
</ul>

<h5 id="toc_48">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_49">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/loginverify?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<h6 id="toc_50">Post body</h6>

<div><pre><code class="language-javascript">{
  &quot;ip&quot;: &quot;192.168.0.101&quot;,
  &quot;user_agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36&quot;,
  &quot;expires_at&quot;: 1572451200
}</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_51">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">number</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h6 id="toc_52">Post body</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">ip</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester IP</td>
</tr>
<tr>
<td style="text-align: left">user_agent</td>
<td style="text-align: left">string</td>
<td style="text-align: left">User-Agent of the requester&#39;s browser</td>
</tr>
<tr>
<td style="text-align: left">expires_at</td>
<td style="text-align: left">number</td>
<td style="text-align: left">Expiration time (in unix time, UTC) of this 2FA request</td>
</tr>
</tbody>
</table>

<h5 id="toc_53">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;order_id&quot;: 10000000002,
  &quot;expires_at&quot;: 1572451200
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">order_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Callback ID. Use this ID to identify specific callback.</td>
</tr>
<tr>
<td style="text-align: left">expires_at</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">The same value with request&#39;s <code>expires_at</code> field</td>
</tr>
</tbody>
</table>

<h4 id="toc_54">Possible Errors</h4>

<h5 id="toc_55">Refer to <a href="#common-errors">Common Errors</a></h5>

<h4 id="toc_56">Callback</h4>

<p>An example of a callback:</p>

<div><pre><code class="language-none">{
  &quot;behavior_type&quot;: 1,
  &quot;behavior_result&quot;: 2,
  &quot;company_id&quot;: 1,
  &quot;order_id&quot;: 10000000002
}</code></pre></div>

<ul>
<li><a href="#callback-definition">View callback definition</a></li>
</ul>

<h5 id="toc_57"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="query-user-status"></a></p>

<h2 id="toc_58">Query User Status</h2>

<p>Query specific user status.</p>

<p><strong><code>GET</code></strong> /v1/vaultx/users/me?email=<code>USER_EMAIL</code>&amp;company_id=<code>COMPANY_ID</code></p>

<ul>
<li><a href="#curl-query-user-status">Sample curl command</a></li>
</ul>

<h5 id="toc_59">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_60">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/users/me?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_61">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h5 id="toc_62">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;user_email&quot;: &quot;johndoe@example.com&quot;,
  &quot;company_id&quot;: 1,
  &quot;is_pair_device&quot;: true,
  &quot;is_setup_pin&quot;: true,
  &quot;is_do_backup&quot;: true,
  &quot;wallets&quot;: [
    {
      &quot;type&quot;: &quot;quorum&quot;,
      &quot;address&quot;: &quot;0x69363AFef99DC6f52daA2C4D0731934d36f7844d&quot;,
      &quot;public_key&quot;: &quot;0x03055b24413ef30be430cf131114ab768f245803c98ef5bf3b3aaafde414f7670e&quot;
    }
  ]
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">user_email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester&#39;s email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester&#39;s company ID</td>
</tr>
<tr>
<td style="text-align: left">is_pair_device</td>
<td style="text-align: left">boolean</td>
<td style="text-align: left">True if device paired, otherwise false</td>
</tr>
<tr>
<td style="text-align: left">is_setup_pin</td>
<td style="text-align: left">boolean</td>
<td style="text-align: left">True if PIN code setup, otherwise false</td>
</tr>
<tr>
<td style="text-align: left">is_do_backup</td>
<td style="text-align: left">boolean</td>
<td style="text-align: left">True if key has been backuped, otherwise false</td>
</tr>
<tr>
<td style="text-align: left">wallets</td>
<td style="text-align: left">array</td>
<td style="text-align: left">Created wallets</td>
</tr>
</tbody>
</table>

<h4 id="toc_63">Possible Errors</h4>

<h5 id="toc_64">Refer to <a href="#common-errors">Common Errors</a></h5>

<h5 id="toc_65"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="backup-user-key"></a></p>

<h2 id="toc_66">Backup User Key</h2>

<p>Following steps below to complete key backup process.</p>

<blockquote>
<p>This process has a callback.</p>
</blockquote>

<ul>
<li><a href="#curl-backup-user-key">Sample curl command</a></li>
</ul>

<h4 id="toc_67">Step 1: Issue a key backup request</h4>

<p><strong><code>POST</code></strong> /v1/vaultx/wallets/backup?email=<code>USER_EMAIL</code>&amp;company_id=<code>COMPANY_ID</code></p>

<h5 id="toc_68">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_69">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/wallets/backup?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<h6 id="toc_70">Post body</h6>

<div><pre><code class="language-javascript">{
  &quot;question&quot;: &quot;YOUR QUESTION&quot;,
  &quot;answer&quot;: &quot;YOUR ANSWER&quot;
}</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_71">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h6 id="toc_72">Post body</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">question</td>
<td style="text-align: left">string</td>
<td style="text-align: left">The chanllenge question while restoring keys</td>
</tr>
<tr>
<td style="text-align: left">answer</td>
<td style="text-align: left">string</td>
<td style="text-align: left">The answer of the chanllenge question</td>
</tr>
</tbody>
</table>

<h5 id="toc_73">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;order_id&quot;: 60000000014,
  &quot;token&quot;: &quot;yMYoEfHenKLDAAMIdVLW5zGrn9E4ap0qE5VrGoXlQaE=&quot;
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">order_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Callback ID. Use this ID to identify specific callback.</td>
</tr>
<tr>
<td style="text-align: left">token</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Submit this token in step 2</td>
</tr>
</tbody>
</table>

<h4 id="toc_74">Step 2: Confirm request on CYBAVO Auth APP</h4>

<p>Once request is replied the callback server will receive a corresponding callback. If request is accepted, continue to step 3 to download the key backup file.</p>

<blockquote>
<p>Specify the callback server on web admin console.</p>
</blockquote>

<h4 id="toc_75">Callback</h4>

<p>An example of a callback:</p>

<div><pre><code class="language-none">{
  &quot;behavior_result&quot;: 2,
  &quot;behavior_type&quot;: 6,
  &quot;company_id&quot;: 1,
  &quot;order_id&quot;: 60000000014
}</code></pre></div>

<ul>
<li><a href="#callback-definition">View callback definition</a></li>
</ul>

<h4 id="toc_76">Step 3: Download key backup file</h4>

<p><strong><code>GET</code></strong> /v1/vaultx/wallets/backup/{TOKEN}?email=<code>USER_EMAIL</code>&amp;company_id=<code>COMPANY_ID</code></p>

<h5 id="toc_77">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_78">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/wallets/backup/yMYoEfHenKLDAAMIdVLW5zGrn9E4ap0qE5VrGoXlQaE=?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_79">API path param</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">token</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Token received in step 1</td>
</tr>
</tbody>
</table>

<h6 id="toc_80">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h5 id="toc_81">Response Format</h5>

<p>Save response body as backup file.</p>

<h4 id="toc_82">Possible Errors</h4>

<h5 id="toc_83">Refer to <a href="#common-errors">Common Errors</a></h5>

<h5 id="toc_84"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="restore-user-key"></a></p>

<h2 id="toc_85">Restore User Key</h2>

<p>Following steps below to complete key restoring process.</p>

<blockquote>
<p>This process has a callback.</p>
</blockquote>

<ul>
<li><a href="#curl-restore-user-key">Sample curl command</a></li>
</ul>

<h4 id="toc_86">Step 1: Upload key backup file to server</h4>

<p><strong><code>POST</code></strong> /v1/vaultx/wallets/upload?email=<code>USER_EMAIL</code>&amp;company_id=<code>COMPANY_ID</code></p>

<h5 id="toc_87">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_88">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/wallets/upload?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<h6 id="toc_89">Post body</h6>

<div><pre><code class="language-none">Content-Type:multipart/form-data; boundary=ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXC

--ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXC
Content-Disposition: form-data;name=&quot;backup&quot;; filename=&quot;backup.dat&quot;
Content-Type: application/octet-stream

.. binary data of the backup file ...

--ZnGpDtePMx0KrHh_G0X99Yef9r8JZsRJSXC</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_90">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h6 id="toc_91">Post body</h6>

<p>Upload backup file using <strong>multipart/form-data</strong> format with name <strong>backup</strong>.</p>

<h5 id="toc_92">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;token&quot;: &quot;yMYoEfHenKLDAAMIdVLW5zGrn9E4ap0qE5VrGoXlQaE=&quot;,
  &quot;question&quot;: &quot;YOUR QUESTION&quot;
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">token</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Submit this token in step 2</td>
</tr>
<tr>
<td style="text-align: left">question</td>
<td style="text-align: left">string</td>
<td style="text-align: left">The chanllenge question submitted with <code>/wallets/backup</code> API</td>
</tr>
</tbody>
</table>

<h4 id="toc_93">Step 2: Submit the answer to restore keys</h4>

<p><strong><code>POST</code></strong> /v1/vaultx/wallets/restore?email=<code>USER_EMAIL</code>&amp;company_id=<code>COMPANY_ID</code></p>

<h5 id="toc_94">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_95">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/wallets/restore?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<h6 id="toc_96">Post body</h6>

<div><pre><code class="language-javascript">{
  &quot;token&quot;: &quot;yMYoEfHenKLDAAMIdVLW5zGrn9E4ap0qE5VrGoXlQaE=&quot;,
  &quot;question&quot;: &quot;YOUR QUESTION&quot;,
  &quot;answer&quot;: &quot;YOUR ANSWER&quot;
}</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_97">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h6 id="toc_98">Post body</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">token</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Token received in step 1</td>
</tr>
<tr>
<td style="text-align: left">question</td>
<td style="text-align: left">string</td>
<td style="text-align: left">The challenge question received in step 1</td>
</tr>
<tr>
<td style="text-align: left">answer</td>
<td style="text-align: left">string</td>
<td style="text-align: left">The answer of the chanllenge question</td>
</tr>
</tbody>
</table>

<h5 id="toc_99">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;token&quot;: &quot;Jd9_oDYP97U7o7DH-5lB8Vqbp4PkqxDCkGz8Df0r79I=&quot;
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">token</td>
<td style="text-align: left">string</td>
<td style="text-align: left"></td>
</tr>
</tbody>
</table>

<h4 id="toc_100">Step 3: Confirm request on CYBAVO Auth APP</h4>

<p>Accept restoring request to reset PIN code.</p>

<h4 id="toc_101">Possible Errors</h4>

<h5 id="toc_102">Refer to <a href="#common-errors">Common Errors</a></h5>

<h5 id="toc_103"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="sign-message"></a></p>

<h2 id="toc_104">Sign Message</h2>

<p>Sign message.</p>

<blockquote>
<p>This API has a callback.</p>

<p>After 2FA request confirmed on CYBAVO Auth APP, the corresponding callback will contain signed message.</p>
</blockquote>

<p><strong><code>POST</code></strong> /v1/vaultx/wallets/signature</p>

<ul>
<li><a href="#curl-sign-message">Sample curl command</a></li>
</ul>

<h5 id="toc_105">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_106">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/wallets/signature?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<h6 id="toc_107">Post body</h6>

<div><pre><code class="language-javascript">{
  &quot;message&quot;: &quot;MESSAGE TO BE SIGNED&quot;
}</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_108">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h6 id="toc_109">Post body</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">message</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Message to be signed</td>
</tr>
</tbody>
</table>

<h5 id="toc_110">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;order_id&quot;: 30000000001
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">order_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Callback ID. Use this ID to identify specific callback.</td>
</tr>
</tbody>
</table>

<h4 id="toc_111">Callback</h4>

<p>An example of a callback:</p>

<div><pre><code class="language-none">{
  &quot;behavior_result&quot;: 2,
  &quot;behavior_type&quot;: 3,
  &quot;company_id&quot;: 1,
  &quot;input&quot;: &quot;{\&quot;message\&quot;:\&quot;MESSAGE TO BE SIGNED\&quot;}&quot;,
  &quot;order_id&quot;: 30000000001,
  &quot;output&quot;: &quot;0xebd938d9c34531b2b847d70125cac4aed7a1177da0d0df0866c65bfc2157fa5b429bc59df60bb977fe451dcc460d6a9709901c25f724def7b491de95fb41837e01&quot;
}</code></pre></div>

<ul>
<li><a href="#callback-definition">View callback definition</a></li>
</ul>

<h4 id="toc_112">Possible Errors</h4>

<h5 id="toc_113">Refer to <a href="#common-errors">Common Errors</a></h5>

<h5 id="toc_114"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="sign-raw-transaction"></a></p>

<h2 id="toc_115">Sign Raw Transaction</h2>

<p>Sign raw transaction.</p>

<blockquote>
<p>This API has a callback.</p>

<p>After 2FA request confirmed, server will call getnonce API to retrieve the nonce of the wallet address. Refer to <a href="#setup-getnonce-api">Setup getnonce API</a> section.</p>
</blockquote>

<p><strong><code>POST</code></strong> /v1/vaultx/wallets/rawtx</p>

<ul>
<li><a href="#curl-sign-raw-transaction">Sample curl command</a></li>
</ul>

<h5 id="toc_116">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_117">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/wallets/rawtx?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<h6 id="toc_118">Post body</h6>

<div><pre><code class="language-javascript">{
  &quot;to&quot;: &quot;0x9576e27257e0eceea565fce04ab1beedfc6f35e4&quot;,
  &quot;gas_limit&quot;: 90000,
  &quot;gas_price&quot;: 1000000000,
  &quot;value&quot;: 1000000000000000000,
  &quot;input&quot;: &quot;0x5448495320495320412054455354494e4720535452494e47&quot;,
  &quot;private&quot;: false
}</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_119">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h6 id="toc_120">Post body</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">to</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Receiver address. If <i>to</i> is empty, it is a contract deployment transaction. Otherwise, it is a normal transaction.</td>
</tr>
<tr>
<td style="text-align: left">gas_limit</td>
<td style="text-align: left">uint64</td>
<td style="text-align: left">Gas limitation</td>
</tr>
<tr>
<td style="text-align: left">gas_price</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Gas price in GWEI. 10<sup>9</sup> GWEI = 1 ETH</td>
</tr>
<tr>
<td style="text-align: left">value</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Amount to transfer in WEI. 10<sup>18</sup> WEI = 1 ETH</td>
</tr>
<tr>
<td style="text-align: left">input</td>
<td style="text-align: left">hex string</td>
<td style="text-align: left">The input data of transaction</td>
</tr>
<tr>
<td style="text-align: left">private</td>
<td style="text-align: left">boolean</td>
<td style="text-align: left">If private is true, use HomesteadSigner otherwise use NewEIP155Signer to sign transaction.</td>
</tr>
</tbody>
</table>

<h5 id="toc_121">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;order_id&quot;: 20000000010
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">order_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Callback ID. Use this ID to identify specific callback.</td>
</tr>
</tbody>
</table>

<h4 id="toc_122">Callback</h4>

<p>An example of a callback:</p>

<div><pre><code class="language-javascript">{
  &quot;behavior_result&quot;: 2,
  &quot;behavior_type&quot;: 2,
  &quot;company_id&quot;: 1,
  &quot;input&quot;: &quot;{\&quot;to\&quot;:\&quot;0x9576e27257e0eceea565fce04ab1beedfc6f35e4\&quot;,\&quot;gas_limit\&quot;:90000,\&quot;gas_price\&quot;:1000000000,\&quot;value\&quot;:1000000000000000000,\&quot;input\&quot;:\&quot;0x5448495320495320412054455354494e4720535452494e47\&quot;,\&quot;private\&quot;:false}&quot;,
  &quot;order_id&quot;: 20000000010,
  &quot;output&quot;: &quot;f88401843b9aca0083015f90949576e27257e0eceea565fce04ab1beedfc6f35e4880de0b6b3a7640000985448495320495320412054455354494e4720535452494e4729a0e7cb1b61aa52529adbdb0c45750f3ac8863882fd270fa387b15fc558a0e097cba0723d0f518fb60a345829c09479e37ab156d4a7c027276848a08ece5e75681f5c&quot;
}</code></pre></div>

<ul>
<li><a href="#callback-definition">View callback definition</a></li>
</ul>

<h4 id="toc_123">Possible Errors</h4>

<h5 id="toc_124">Refer to <a href="#common-errors">Common Errors</a></h5>

<h5 id="toc_125"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="decrypt-message"></a></p>

<h2 id="toc_126">Decrypt Message</h2>

<p>Decrypt the message which encrypted by requester&#39;s public key.</p>

<blockquote>
<p>This API has a callback.</p>

<p>After 2FA request confirmed on CYBAVO Auth APP, the corresponding callback will contain decrypted message.</p>
</blockquote>

<p><strong><code>POST</code></strong> /v1/vaultx/wallets/decrypt</p>

<ul>
<li><a href="#curl-decrypt-message">Sample curl command</a></li>
</ul>

<h5 id="toc_127">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_128">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/wallets/decrypt?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<h6 id="toc_129">Post body</h6>

<div><pre><code class="language-javascript">{
  &quot;secret&quot;: &quot;0x04c7a7db0953984c6b3127a65300a86732a1799f076137a2619d913b84bf3130ff5fb947ac5b01706d902cb4fee021148eb0299626fb7c69f5e763ba3657fcef51f2326178289ac4d63d424444abaac33ec3c66844e5cd19d6ce12dcb48abadb2cd0d6eba06d7a074ee4e8b2cdf6b2bea34a059c2fadedd23b6ba61e1a537e3fa47a0a7137fd8171b0ec894164bbb3418c53823475fcdca0fc41b2480cb28bb2a52bffaaddbd89143a5e5c63e46014e3a44f6c9176a6e1410aecd331ccaad062cb5e3cd9cf813e3a6fa1425b2d61fd904429c6a4b3bb5f5bca12364c46dc019f28766dc8058f116393cc57d556e80efa1bd784c05d8b6ddfe9a173d0161b5db7f50859cb908bca6e9abf05a8649dfd5997b70313f9fe48e882670ce4def568b8239910acf8ebae8089ee17d53c7222fa895d9ce98f7d43d4df84a3f4a3a41d9c55a85f395f8ee2bbf7c07b0aa5b664a38ef7c40a0ec5c3039833dafd3b75b3f83d6a58effc6b959a7e0af8a09a9b40d7ec54dbb2f86dfb2750a8df&quot;
}</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_130">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h6 id="toc_131">Post body</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">secret</td>
<td style="text-align: left">hex string</td>
<td style="text-align: left">The message encrypted by requester&#39;s public key</td>
</tr>
</tbody>
</table>

<blockquote>
<p>The public key could be retrieved by <strong>/users/me</strong> API</p>
</blockquote>

<h5 id="toc_132">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;order_id&quot;: 70000000001
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">order_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Callback ID. Use this ID to identify specific callback.</td>
</tr>
</tbody>
</table>

<h4 id="toc_133">Callback</h4>

<p>An example of a callback:</p>

<div><pre><code class="language-javascript">{
  &quot;behavior_result&quot;: 2,
  &quot;behavior_type&quot;: 7,
  &quot;company_id&quot;: 3,
  &quot;input&quot;: &quot;{\&quot;secret\&quot;:\&quot;0x04c7a7db0953984c6b3127a65300a86732a1799f076137a2619d913b84bf3130ff5fb947ac5b01706d902cb4fee021148eb0299626fb7c69f5e763ba3657fcef51f2326178289ac4d63d424444abaac33ec3c66844e5cd19d6ce12dcb48abadb2cd0d6eba06d7a074ee4e8b2cdf6b2bea34a059c2fadedd23b6ba61e1a537e3fa47a0a7137fd8171b0ec894164bbb3418c53823475fcdca0fc41b2480cb28bb2a52bffaaddbd89143a5e5c63e46014e3a44f6c9176a6e1410aecd331ccaad062cb5e3cd9cf813e3a6fa1425b2d61fd904429c6a4b3bb5f5bca12364c46dc019f28766dc8058f116393cc57d556e80efa1bd784c05d8b6ddfe9a173d0161b5db7f50859cb908bca6e9abf05a8649dfd5997b70313f9fe48e882670ce4def568b8239910acf8ebae8089ee17d53c7222fa895d9ce98f7d43d4df84a3f4a3a41d9c55a85f395f8ee2bbf7c07b0aa5b664a38ef7c40a0ec5c3039833dafd3b75b3f83d6a58effc6b959a7e0af8a09a9b40d7ec54dbb2f86dfb2750a8df\&quot;}&quot;,
  &quot;order_id&quot;: 70000000013,
  &quot;output&quot;: &quot;0x7b22636f6e74656e74223a2248656c6c6f20576f726c64222c2265787069726174696f6e223a22323031392d31312d30365431303a34313a30372e3133393837392b30383a3030222c2268617368223a22307862643662663637636638633130643833653330346339623833386263313064353565363930613439646332333730333063333862366539373231333237643833222c226d6573736167655f68617368223a22516d596674383674376934315663713379354476734455533333485a6a475a6d714b5a796577503145386732596a222c22737461747573223a302c2274696d65223a22323031392d31302d30375431303a34313a30372e3133393837392b30383a3030227d&quot;
}</code></pre></div>

<ul>
<li><a href="#callback-definition">View callback definition</a></li>
</ul>

<h4 id="toc_134">Possible Errors</h4>

<h5 id="toc_135">Refer to <a href="#common-errors">Common Errors</a></h5>

<h5 id="toc_136"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="query-callback-status"></a></p>

<h2 id="toc_137">Query Callback Status</h2>

<p>Query callbacks&#39; status belong to requester&#39;s company.</p>

<p><strong><code>POST</code></strong> /v1/vaultx/order/status</p>

<ul>
<li><a href="#curl-query-callback-status">Sample curl command</a></li>
</ul>

<h5 id="toc_138">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_139">API with query string</h6>

<div><pre><code class="language-none">/v1/vaultx/order/status?email=johndoe@example.com&amp;company_id=1</code></pre></div>

<h6 id="toc_140">Post body</h6>

<div><pre><code class="language-javascript">{
  &quot;order_ids&quot;: [
    10000000004,
    20000000004,
    30000000001
  ]
}</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_141">Query string</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">email</td>
<td style="text-align: left">string</td>
<td style="text-align: left">Requester email</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h6 id="toc_142">Post body</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">order_ids</td>
<td style="text-align: left">array</td>
<td style="text-align: left">ID of callbacks</td>
</tr>
</tbody>
</table>

<h5 id="toc_143">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;order_status&quot;: [
    {
      &quot;is_exist&quot;: true,
      &quot;order_id&quot;: 10000000004,
      &quot;behavior_type&quot;: 1,
      &quot;behavior_result&quot;: 2,
      &quot;addon&quot;: {}
    },
    {
      &quot;is_exist&quot;: true,
      &quot;order_id&quot;: 20000000004,
      &quot;behavior_type&quot;: 2,
      &quot;behavior_result&quot;: 2,
      &quot;addon&quot;: {
        &quot;input&quot;: &quot;{\&quot;from\&quot;:\&quot;0x81b7e08f65bdf5648606c89998a9cc8164397647\&quot;,\&quot;to\&quot;:\&quot;0x9576e27257e0eceea565fce04ab1beedfc6f35e4\&quot;,\&quot;gas_limit\&quot;:90000,\&quot;gas_price\&quot;:1000000000,\&quot;value\&quot;:1000000000000000000,\&quot;nonce\&quot;:0,\&quot;data\&quot;:null,\&quot;input\&quot;:\&quot;0x414243\&quot;,\&quot;private_from\&quot;:\&quot;\&quot;,\&quot;private_for\&quot;:null,\&quot;private_tx_type\&quot;:\&quot;\&quot;}&quot;,
        &quot;output&quot;: &quot;f86582250f8083015f90949576e27257e0eceea565fce04ab1beedfc6f35e4808341424329a083c60d3f302c20390bb1fae0db919ef245542a903fcdeed95aecbcfc9ff844dea0613a4274ae4243ea2f2cc2dddcd64b8484b706f945c546b90eabbb0ac4cbe80f&quot;
      }
    },
    {
      &quot;is_exist&quot;: true,
      &quot;order_id&quot;: 30000000001,
      &quot;behavior_type&quot;: 3,
      &quot;behavior_result&quot;: 2,
      &quot;addon&quot;: {
        &quot;input&quot;: &quot;{\&quot;message\&quot;:\&quot;MESSAGE TO BE SIGNED\&quot;}&quot;,
        &quot;output&quot;: &quot;0x06a2c198b7670bd47d1433bfe497ee0d5019fe2b78ba7b1fe6ae99c134deb5d23d045d5cf3bf314fa77cf8da060e141bf5e9d36c488000bab81e9f56c6a46f4f01&quot;
      }
    }
  ]
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">is_exist</td>
<td style="text-align: left">boolean</td>
<td style="text-align: left">This order_id exists or not</td>
</tr>
<tr>
<td style="text-align: left">order_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">ID of callback</td>
</tr>
<tr>
<td style="text-align: left">behavior_type</td>
<td style="text-align: left">int</td>
<td style="text-align: left"><a href="#callback-definition">View callback definition</a></td>
</tr>
<tr>
<td style="text-align: left">behavior_result</td>
<td style="text-align: left">int</td>
<td style="text-align: left"><a href="#callback-definition">View callback definition</a></td>
</tr>
<tr>
<td style="text-align: left">addon</td>
<td style="text-align: left">object</td>
<td style="text-align: left">The input and output fields of callback</td>
</tr>
</tbody>
</table>

<p><a name="mock-server"></a></p>

<h1 id="toc_144">Mock Server</h1>

<h2 id="toc_145">Setup Configuration</h2>

<blockquote>
<p>Set following configuration in mockserver.app.conf</p>

<blockquote>
<p>Require API code and API secret on web admin console</p>
</blockquote>
</blockquote>

<div><pre><code class="language-none">api_server_url=&quot;&quot;
api_code=&quot;&quot;
api_secret=&quot;&quot;</code></pre></div>

<h2 id="toc_146">Register mock server URL</h2>

<blockquote>
<p>Operate on web admin console</p>
</blockquote>

<p>Callback URL</p>

<div><pre><code class="language-none">http://localhost:8890/v1/mock/callback</code></pre></div>

<p>GetNonce URL</p>

<div><pre><code class="language-none">http://localhost:8890/v1/mock/getnonce</code></pre></div>

<h2 id="toc_147">How to compile</h2>

<ul>
<li>Put sample code to {YOUR_GO_PATH}/github.com/cybavo/VAULTX_MOCK_SERVER</li>
<li>Execute

<ul>
<li>glide install</li>
<li>go build ./mockserver.go</li>
<li>./mockserver</li>
</ul></li>
</ul>

<p><a name="curl-testing-commands"></a></p>

<h2 id="toc_148">CURL Testing Commands</h2>

<p><a name="curl-register-new-user"></a></p>

<h4 id="toc_149">Register a new user</h4>

<div><pre><code class="language-none">curl -X POST -d &#39;{&quot;name&quot;:&quot;JOHN DOE&quot;,&quot;email&quot;:&quot;johndoe@example.com&quot;,&quot;locale&quot;:&quot;en&quot;}&#39; \
&quot;http://localhost:8890/v1/mock/users&quot;</code></pre></div>

<ul>
<li><a href="#register-new-user">API definition</a></li>
</ul>

<p><a name="curl-pair-device"></a></p>

<h4 id="toc_150">Pair device</h4>

<div><pre><code class="language-none">curl -X POST &quot;http://localhost:8890/v1/mock/devices?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<ul>
<li><a href="#pair-device">API definition</a></li>
</ul>

<p><a name="curl-setup-pin-code"></a></p>

<h4 id="toc_151">Setup PIN code</h4>

<div><pre><code class="language-none">curl -X POST &quot;http://localhost:8890/v1/mock/users/pin?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<ul>
<li><a href="#setup-pin-code">API definition</a></li>
</ul>

<p><a name="curl-repair-device"></a></p>

<h4 id="toc_152">Repair device</h4>

<h6 id="toc_153">Step 1: Issue a repair device request</h6>

<div><pre><code class="language-none">curl -X POST &quot;http://localhost:8890/v1/mock/devices/repair?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<h6 id="toc_154">step 2: Check email to get 6-digit verification code</h6>

<h6 id="toc_155">Step 3: Continue repairing process</h6>

<div><pre><code class="language-none">curl -X POST -d &#39;{&quot;token&quot;:&quot;TOKEN_FROM_SETP1&quot;,&quot;verify_num&quot;:VERIFICATION_CODE_FROM_EMAIL}&#39; \
&quot;http://localhost:8890/v1/mock/devices/repair?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<ul>
<li><a href="#repair-device">API definition</a></li>
</ul>

<p><a name="curl-issue-user-login-request"></a></p>

<h4 id="toc_156">Issue a user login request</h4>

<div><pre><code class="language-none">curl -X POST -d &#39;{&quot;ip&quot;:&quot;192.168.0.1&quot;,&quot;user_agent&quot;:&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/77.0.3865.120 Safari/537.36&quot;,&quot;expires_at&quot;:1572451200}&#39; \
&quot;http://localhost:8890/v1/mock/loginverify?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<ul>
<li><a href="#issue-user-login-request">API definition</a></li>
</ul>

<p><a name="curl-query-user-status"></a></p>

<h4 id="toc_157">Query user status</h4>

<div><pre><code class="language-none">curl -X GET &quot;http://localhost:8890/v1/mock/users/me?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<ul>
<li><a href="#query-user-status">API definition</a></li>
</ul>

<p><a name="curl-backup-user-key"></a></p>

<h4 id="toc_158">Backup user key</h4>

<h6 id="toc_159">Step 1: Issue a key backup request</h6>

<div><pre><code class="language-none">curl -X POST -d &#39;{&quot;question&quot;:&quot;YOUR QUESTION&quot;,&quot;answer&quot;:&quot;YOUR ANSWER&quot;}&#39; \
&quot;http://localhost:8890/v1/mock/wallets/backup?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<h6 id="toc_160">Step 2: Confirm request on CYBAVO Auth APP</h6>

<h6 id="toc_161">Step 3: Download key backup file</h6>

<div><pre><code class="language-none">curl -X GET &quot;http://localhost:8890/v1/mock/wallets/backup/{TOKEN}?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<ul>
<li><a href="#backup-user-key">API definition</a></li>
</ul>

<p><a name="curl-restore-user-key"></a></p>

<h4 id="toc_162">Restore user key</h4>

<h6 id="toc_163">Step 1: Upload key backup file to server</h6>

<div><pre><code class="language-none">curl -X POST &quot;http://localhost:8890/v1/mock/wallets/upload?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<h6 id="toc_164">Step 2: Submit the answer to restore keys</h6>

<div><pre><code class="language-none">curl -X POST -d &#39;{&quot;token&quot;:&quot;TOKEN FROM SERVER&quot;,&quot;question&quot;:&quot;QUESTION FROM SERVER&quot;,&quot;answer&quot;:&quot;YOUR ANSWER&quot;}&#39; \
&quot;http://localhost:8890/v1/mock/wallets/restore?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<h6 id="toc_165">Step 3: Confirm request on CYBAVO Auth APP</h6>

<ul>
<li><a href="#restore-user-key">API definition</a></li>
</ul>

<p><a name="curl-sign-message"></a></p>

<h4 id="toc_166">Sign Message</h4>

<div><pre><code class="language-none">curl -X POST -d &#39;{&quot;message&quot;:&quot;MESSAGE TO BE SIGNED&quot;}&#39; \
&quot;http://localhost:8890/v1/mock/wallets/signature?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<ul>
<li><a href="#sign-message">API definition</a></li>
</ul>

<p><a name="curl-sign-raw-transaction"></a></p>

<h4 id="toc_167">Sign Transaction</h4>

<div><pre><code class="language-none">curl -X POST -d &#39;{&quot;to&quot;:&quot;0x9576e27257e0eceea565fce04ab1beedfc6f35e4&quot;,&quot;gas_limit&quot;:90000,&quot;gas_price&quot;:1000000000,&quot;value&quot;:1000000000000000000,&quot;input&quot;:&quot;0x5448495320495320412054455354494e4720535452494e47&quot;,&quot;private&quot;:false}&#39; \
&quot;http://localhost:8890/v1/mock/wallets/rawtx?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<ul>
<li><a href="#sign-raw-transaction">API definition</a></li>
</ul>

<p><a name="curl-decrypt-message"></a></p>

<h4 id="toc_168">Decrypt Message</h4>

<div><pre><code class="language-none">curl -X POST -d &#39;{&quot;secret&quot;:&quot;0x04c7a7db0953984c6b3127a65300a86732a1799f076137a2619d913b84bf3130ff5fb947ac5b01706d902cb4fee021148eb0299626fb7c69f5e763ba3657fcef51f2326178289ac4d63d424444abaac33ec3c66844e5cd19d6ce12dcb48abadb2cd0d6eba06d7a074ee4e8b2cdf6b2bea34a059c2fadedd23b6ba61e1a537e3fa47a0a7137fd8171b0ec894164bbb3418c53823475fcdca0fc41b2480cb28bb2a52bffaaddbd89143a5e5c63e46014e3a44f6c9176a6e1410aecd331ccaad062cb5e3cd9cf813e3a6fa1425b2d61fd904429c6a4b3bb5f5bca12364c46dc019f28766dc8058f116393cc57d556e80efa1bd784c05d8b6ddfe9a173d0161b5db7f50859cb908bca6e9abf05a8649dfd5997b70313f9fe48e882670ce4def568b8239910acf8ebae8089ee17d53c7222fa895d9ce98f7d43d4df84a3f4a3a41d9c55a85f395f8ee2bbf7c07b0aa5b664a38ef7c40a0ec5c3039833dafd3b75b3f83d6a58effc6b959a7e0af8a09a9b40d7ec54dbb2f86dfb2750a8df&quot;}&#39; \
&quot;http://localhost:8890/v1/mock/wallets/decrypt?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<ul>
<li><a href="#decrypt-message">API definition</a></li>
</ul>

<p><a name="curl-query-callback-status"></a></p>

<h4 id="toc_169">Query Callback Status</h4>

<div><pre><code class="language-none">curl -X POST -d &#39;{&quot;order_ids&quot;:[10000000002,10000000003]}&#39; \
&quot;http://localhost:8890/v1/mock/order/status?email=johndoe@example.com&amp;company_id=1&quot;</code></pre></div>

<ul>
<li><a href="#query-callback-status">API definition</a></li>
</ul>

<h5 id="toc_170"><a href="#table-of-contents">Back to top</a></h5>

<h1 id="toc_171">Appendix</h1>

<p><a name="callback-definition"></a></p>

<h2 id="toc_172">Callback Definition</h2>

<table>
  <tr>
    <td>Field</td>
    <td>Type</td>
    <td>Description</td>
  </tr>
  <tr>
    <td>order_id</td>
    <td> int64 </td>
    <td>ID of callback</td>
  </tr>
  <tr>
    <td>company_id</td>
    <td>int64</td>
    <td>ID of requester's company</td>
  </tr>
  <tr>
    <td>behavior_type</td>
    <td>number</td>
    <td rowspan="7">
      <b>1</b> - Login<br>
      <b>2</b> - Sign raw tx<br>
      <b>3</b> - Sign signature<br>
      <b>4</b> - Pair device<br>
      <b>5</b> - Setup PIN code<br>
      <b>6</b> - Backup user key<br>
      <b>7</b> - Decrypt message<br>
    </td>
  </tr>
  <tr></tr>
  <tr></tr>
  <tr></tr>
  <tr></tr>
  <tr></tr>
  <tr></tr>
  <tr>
    <td>behavior_result</td>
    <td>number</td>
    <td rowspan="4">
      <b>0</b> - Pending<br>
      <b>1</b> - Rejected<br>
      <b>2</b> - Accepted<br>
      <b>3</b> - Expired<br>
      <b>4</b> - Failed
    </td>
  </tr>
  <tr></tr>
  <tr></tr>
  <tr></tr>
  <tr>
    <td>input</td>
    <td>json string</td>
    <td rowspan=3>
      behavior_type<br>
      <b>2</b> - the raw transaction to sign<br>
      <b>3</b> - the message to sign<br>
      <b>7</b> - the message to decrypt (hex string)<br>
    </td>
  </tr>
  <tr></tr>
  <tr></tr>
  <tr>
    <td>output</td>
    <td>hex string</td>
    <td rowspan=4>
      behavior_type<br>
      <b>2</b> - the signed transaction<br>
      <b>3</b> - the signed message<br>
      <b>7</b> - the decrypted message (hex string)<br>
    </td>
  </tr>
</table>

<h5 id="toc_173"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="api-callback-list"></a></p>

<h2 id="toc_174">API Callback List</h2>

<table>
<thead>
<tr>
<th style="text-align: left">API</th>
<th style="text-align: left">Callback Type</th>
<th style="text-align: left">Input/Output</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">/loginverify</td>
<td style="text-align: left">1</td>
<td style="text-align: left">-</td>
</tr>
<tr>
<td style="text-align: left">/wallets/rawtx</td>
<td style="text-align: left">2</td>
<td style="text-align: left">yes</td>
</tr>
<tr>
<td style="text-align: left">/wallets/signature</td>
<td style="text-align: left">3</td>
<td style="text-align: left">yes</td>
</tr>
<tr>
<td style="text-align: left">/devices</td>
<td style="text-align: left">4</td>
<td style="text-align: left">-</td>
</tr>
<tr>
<td style="text-align: left">/devices/repair</td>
<td style="text-align: left">4</td>
<td style="text-align: left">-</td>
</tr>
<tr>
<td style="text-align: left">/users/pin</td>
<td style="text-align: left">5</td>
<td style="text-align: left">-</td>
</tr>
<tr>
<td style="text-align: left">/wallets/backup</td>
<td style="text-align: left">6</td>
<td style="text-align: left">-</td>
</tr>
<tr>
<td style="text-align: left">/wallets/decrypt</td>
<td style="text-align: left">7</td>
<td style="text-align: left">yes</td>
</tr>
</tbody>
</table>

<h5 id="toc_175"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="common-errors"></a></p>

<h2 id="toc_176">Common Errors</h2>

<table>
<thead>
<tr>
<th style="text-align: left">HTTP Status Code</th>
<th style="text-align: left">Error Code</th>
<th style="text-align: left">Error Message</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">400</td>
<td style="text-align: left">112</td>
<td style="text-align: left">Invalid parameter</td>
</tr>
<tr>
<td style="text-align: left">400</td>
<td style="text-align: left">-</td>
<td style="text-align: left">JSON unmarshal failure reason</td>
</tr>
<tr>
<td style="text-align: left">403</td>
<td style="text-align: left">-</td>
<td style="text-align: left">Forbidden</td>
</tr>
<tr>
<td style="text-align: left">403</td>
<td style="text-align: left">703</td>
<td style="text-align: left">Operation failed</td>
</tr>
<tr>
<td style="text-align: left">503</td>
<td style="text-align: left">903</td>
<td style="text-align: left">KMS out of serivce. Please try again later.</td>
</tr>
</tbody>
</table>

<h5 id="toc_177"><a href="#table-of-contents">Back to top</a></h5>

<p><a name="setup-getnonce-api"></a></p>

<h2 id="toc_178">Setup getnonce API</h2>

<p>During the raw transation signing process, the CYBAVO server will invoke getnonce API to retrieve the nonce of the wallet address.</p>

<blockquote>
<p>Set the getnonce API URL on web admin console.</p>
</blockquote>

<h5 id="toc_179">Request Format</h5>

<p>An example of the request:</p>

<h6 id="toc_180">Post body</h6>

<div><pre><code class="language-javascript">{
    &quot;address&quot;: &quot;0x94b3d188620bf633f6bff5f8c718b4bfbaca0c55&quot;,
    &quot;company_id&quot;: 1
}</code></pre></div>

<p>The request includes the following parameters:</p>

<h6 id="toc_181">Post body</h6>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">address</td>
<td style="text-align: left">string</td>
<td style="text-align: left">The address of the requester&#39;s wallet</td>
</tr>
<tr>
<td style="text-align: left">company_id</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">Requester company ID</td>
</tr>
</tbody>
</table>

<h5 id="toc_182">Response Format</h5>

<p>An example of a successful response:</p>

<div><pre><code class="language-javascript">{
  &quot;nonce&quot;: 1
}</code></pre></div>

<p>The response includes the following parameters:</p>

<table>
<thead>
<tr>
<th style="text-align: left">Field</th>
<th style="text-align: left">Type</th>
<th style="text-align: left">Description</th>
</tr>
</thead>

<tbody>
<tr>
<td style="text-align: left">nonce</td>
<td style="text-align: left">int64</td>
<td style="text-align: left">The nonce of given address</td>
</tr>
</tbody>
</table>

<blockquote>
<p>Refer to <a href="controllers/CallbackController.go">CallbackController.go</a></p>
</blockquote>




</body>

</html>
